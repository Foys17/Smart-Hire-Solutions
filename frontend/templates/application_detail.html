{% extends 'base.html' %}

{% block content %}
<div class="max-w-7xl mx-auto">
    <div class="bg-white rounded-2xl shadow-sm border border-slate-200 p-6 mb-8 flex justify-between items-center">
        <div>
            <h2 class="text-2xl font-bold text-slate-900">{{ app.candidate.full_name }}</h2>
            <p class="text-slate-500">Applying for <span class="font-semibold text-indigo-600">{{ app.job.title }}</span></p>
        </div>
        <div class="text-right">
            <div class="text-4xl font-extrabold {% if app.match_score > 75 %}text-green-600{% elif app.match_score > 50 %}text-amber-500{% else %}text-red-500{% endif %}">
                {{ app.match_score }}%
            </div>
            <div class="text-xs font-bold uppercase tracking-wide text-slate-400">Match Score</div>
        </div>
    </div>

    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
        
        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
            <div class="bg-slate-50 border-b border-slate-200 px-4 py-3 font-bold text-slate-800">
                üéØ Job Requirements
            </div>
            <div class="p-4 space-y-2">
                {% for item in app.job.gliner_entities %}
                    {% if item.label in 'Skill,Technology,Framework,Programming Language,Database' %}
                        <span class="inline-block px-2 py-1 bg-white border border-slate-200 rounded text-xs text-slate-600 shadow-sm">{{ item.text }}</span>
                    {% endif %}
                {% endfor %}
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden relative z-10 scale-105">
            <div class="bg-slate-800 text-white px-4 py-3 font-bold text-center">
                ‚öñÔ∏è Gap Analysis
            </div>
            <div class="p-6">
                <div class="mb-6">
                    <h4 class="text-xs font-bold uppercase text-green-600 mb-2">Matches</h4>
                    <div class="flex flex-col gap-1">
                        {% for skill in matches %}
                            <div class="flex items-center gap-2 text-sm text-slate-700">
                                <i class="bi bi-check-circle-fill text-green-500"></i> {{ skill }}
                            </div>
                        {% empty %}
                            <span class="text-xs text-slate-400 italic">No direct matches.</span>
                        {% endfor %}
                    </div>
                </div>
                <div>
                    <h4 class="text-xs font-bold uppercase text-red-500 mb-2">Missing</h4>
                    <div class="flex flex-col gap-1">
                        {% for skill in misses %}
                            <div class="flex items-center gap-2 text-sm text-slate-500 opacity-70">
                                <i class="bi bi-x-circle-fill text-red-400"></i> {{ skill }}
                            </div>
                        {% empty %}
                            <span class="text-xs text-green-600 font-bold">Perfect Match!</span>
                        {% endfor %}
                    </div>
                </div>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
            <div class="bg-indigo-50 border-b border-indigo-100 px-4 py-3 font-bold text-indigo-900">
                üë§ Candidate Profile
            </div>
            <div class="p-4">
                <div class="mb-4">
                    <h4 class="text-xs font-bold text-indigo-400 uppercase mb-2">All Detected Skills</h4>
                    <div class="flex flex-wrap gap-1">
                        {% for item in app.extracted_data %}
                            {% if item.label in 'Skill,Technology,Framework,Database' %}
                                <span class="px-2 py-0.5 bg-indigo-50 text-indigo-700 rounded text-xs">{{ item.text }}</span>
                            {% endif %}
                        {% endfor %}
                    </div>
                </div>
                <div>
                    <h4 class="text-xs font-bold text-indigo-400 uppercase mb-2">Experience & Education</h4>
                    <ul class="text-sm space-y-1 text-slate-600">
                        {% for item in app.extracted_data %}
                            {% if item.label in 'Job Title,Degree,University,Experience' %}
                                <li class="flex items-start gap-2">
                                    <span class="px-1.5 rounded bg-slate-100 text-slate-500 text-[10px] uppercase tracking-wider font-bold mt-0.5">{{ item.label }}</span>
                                    <span>{{ item.text }}</span>
                                </li>
                            {% endif %}
                        {% endfor %}
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}